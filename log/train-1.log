(.venv) sj683@en-cs-trummer-gpu01:~/replicate$ /home/sj683/replicate/.venv/bin/python /home/sj683/replicate/train.py
train - Dropping missing values: 90233 >> 90224
dev - Dropping missing values: 12792 >> 12792
test - Dropping missing values: 12779 >> 12779
Some weights of the model checkpoint at bert-base-multilingual-cased were not used when initializing BertForSequenceClassification: ['cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.bias', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-multilingual-cased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
cuda:0
/home/sj683/replicate/.venv/lib/python3.8/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
  0%|                                                                                                                                                                                                                                                                                        | 0/16917 [00:00<?, ?it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6967, 'learning_rate': 4.852219660696341e-05, 'epoch': 0.09}                                                                                                                                                                                                                                                
  3%|███████▉                                                                                                                                                                                                                                                                    | 500/16917 [03:35<1:57:18,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6952, 'learning_rate': 4.7044393213926825e-05, 'epoch': 0.18}                                                                                                                                                                                                                                               
  6%|███████████████▊                                                                                                                                                                                                                                                           | 1000/16917 [07:12<1:53:48,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6933, 'learning_rate': 4.556658982089023e-05, 'epoch': 0.27}                                                                                                                                                                                                                                                
  9%|███████████████████████▋                                                                                                                                                                                                                                                   | 1500/16917 [10:49<1:49:55,  2.34it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6918, 'learning_rate': 4.408878642785364e-05, 'epoch': 0.35}                                                                                                                                                                                                                                                
 12%|███████████████████████████████▌                                                                                                                                                                                                                                           | 2000/16917 [14:26<1:46:41,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6925, 'learning_rate': 4.261098303481705e-05, 'epoch': 0.44}                                                                                                                                                                                                                                                
 15%|███████████████████████████████████████▍                                                                                                                                                                                                                                   | 2500/16917 [18:03<1:43:21,  2.32it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6907, 'learning_rate': 4.113317964178046e-05, 'epoch': 0.53}                                                                                                                                                                                                                                                
 18%|███████████████████████████████████████████████▎                                                                                                                                                                                                                           | 3000/16917 [21:40<1:39:19,  2.34it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6917, 'learning_rate': 3.965537624874387e-05, 'epoch': 0.62}                                                                                                                                                                                                                                                
 21%|███████████████████████████████████████████████████████▏                                                                                                                                                                                                                   | 3500/16917 [25:17<1:36:01,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.693, 'learning_rate': 3.817757285570728e-05, 'epoch': 0.71}                                                                                                                                                                                                                                                 
 24%|███████████████████████████████████████████████████████████████▏                                                                                                                                                                                                           | 4000/16917 [28:54<1:32:16,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6902, 'learning_rate': 3.6699769462670686e-05, 'epoch': 0.8}                                                                                                                                                                                                                                                
 27%|███████████████████████████████████████████████████████████████████████                                                                                                                                                                                                    | 4500/16917 [32:30<1:28:45,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6918, 'learning_rate': 3.52219660696341e-05, 'epoch': 0.89}                                                                                                                                                                                                                                                 
 30%|██████████████████████████████████████████████████████████████████████████████▉                                                                                                                                                                                            | 5000/16917 [36:08<1:25:23,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6907, 'learning_rate': 3.374416267659751e-05, 'epoch': 0.98}                                                                                                                                                                                                                                                
 33%|██████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                                                                                    | 5500/16917 [39:45<1:21:41,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'eval_loss': 0.6946449875831604, 'eval_accuracy': 0.5064102564102564, 'eval_runtime': 130.3745, 'eval_samples_per_second': 98.117, 'eval_steps_per_second': 6.136, 'epoch': 1.0}                                                                                                                                      
 33%|█████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                                  | 5639/16917 [42:57<1:20:45,  2.33it/s/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.                                                                                         
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.69, 'learning_rate': 3.2266359283560916e-05, 'epoch': 1.06}                                                                                                                                                                                                                                                 
 35%|██████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                            | 6000/16917 [45:33<1:18:09,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6912, 'learning_rate': 3.078855589052433e-05, 'epoch': 1.15}                                                                                                                                                                                                                                                
 38%|██████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                                                    | 6500/16917 [49:10<1:14:54,  2.32it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6889, 'learning_rate': 2.9310752497487738e-05, 'epoch': 1.24}                                                                                                                                                                                                                                               
 41%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                                            | 7000/16917 [52:47<1:11:03,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6908, 'learning_rate': 2.7832949104451146e-05, 'epoch': 1.33}                                                                                                                                                                                                                                               
 44%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                    | 7500/16917 [56:24<1:07:24,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6876, 'learning_rate': 2.6355145711414554e-05, 'epoch': 1.42}                                                                                                                                                                                                                                               
 47%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                           | 8000/16917 [1:00:01<1:03:51,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.69, 'learning_rate': 2.4877342318377965e-05, 'epoch': 1.51}                                                                                                                                                                                                                                                 
 50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                                   | 8500/16917 [1:03:38<1:00:06,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6897, 'learning_rate': 2.3399538925341373e-05, 'epoch': 1.6}                                                                                                                                                                                                                                                
 53%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                             | 9000/16917 [1:07:15<56:33,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6883, 'learning_rate': 2.1921735532304784e-05, 'epoch': 1.68}                                                                                                                                                                                                                                               
 56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                                     | 9500/16917 [1:10:52<53:11,  2.32it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6901, 'learning_rate': 2.044393213926819e-05, 'epoch': 1.77}                                                                                                                                                                                                                                                
 59%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                            | 10000/16917 [1:14:29<49:31,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6891, 'learning_rate': 1.8966128746231603e-05, 'epoch': 1.86}                                                                                                                                                                                                                                               
 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                     | 10500/16917 [1:18:06<45:52,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6897, 'learning_rate': 1.748832535319501e-05, 'epoch': 1.95}                                                                                                                                                                                                                                                
 65%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                             | 11000/16917 [1:21:43<42:21,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'eval_loss': 0.6966302990913391, 'eval_accuracy': 0.5064102564102564, 'eval_runtime': 130.4701, 'eval_samples_per_second': 98.045, 'eval_steps_per_second': 6.132, 'epoch': 2.0}                                                                                                                                      
 67%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                        | 11278/16917 [1:25:55<40:16,  2.33it/s/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.                                                                                         
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6889, 'learning_rate': 1.601052196015842e-05, 'epoch': 2.04}                                                                                                                                                                                                                                                
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                     | 11500/16917 [1:27:31<38:44,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.688, 'learning_rate': 1.4532718567121831e-05, 'epoch': 2.13}                                                                                                                                                                                                                                                
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                             | 12000/16917 [1:31:08<35:06,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6885, 'learning_rate': 1.3054915174085242e-05, 'epoch': 2.22}                                                                                                                                                                                                                                               
 74%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                     | 12500/16917 [1:34:45<31:38,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6884, 'learning_rate': 1.157711178104865e-05, 'epoch': 2.31}                                                                                                                                                                                                                                                
 77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                             | 13000/16917 [1:38:22<28:03,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6878, 'learning_rate': 1.009930838801206e-05, 'epoch': 2.39}                                                                                                                                                                                                                                                
 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                     | 13500/16917 [1:41:59<24:24,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6886, 'learning_rate': 8.621504994975469e-06, 'epoch': 2.48}                                                                                                                                                                                                                                                
 83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                             | 14000/16917 [1:45:36<20:50,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6885, 'learning_rate': 7.143701601938878e-06, 'epoch': 2.57}                                                                                                                                                                                                                                                
 86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 14500/16917 [1:49:13<17:18,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6883, 'learning_rate': 5.665898208902288e-06, 'epoch': 2.66}                                                                                                                                                                                                                                                
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                              | 15000/16917 [1:52:50<13:43,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6891, 'learning_rate': 4.1880948158656974e-06, 'epoch': 2.75}                                                                                                                                                                                                                                               
 92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                      | 15500/16917 [1:56:27<10:09,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6885, 'learning_rate': 2.710291422829107e-06, 'epoch': 2.84}                                                                                                                                                                                                                                                
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌              | 16000/16917 [2:00:04<06:33,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6875, 'learning_rate': 1.2324880297925164e-06, 'epoch': 2.93}                                                                                                                                                                                                                                               
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍      | 16500/16917 [2:03:41<02:58,  2.33it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'eval_loss': 0.6974221467971802, 'eval_accuracy': 0.5064102564102564, 'eval_runtime': 130.4405, 'eval_samples_per_second': 98.068, 'eval_steps_per_second': 6.133, 'epoch': 3.0}                                                                                                                                      
{'train_runtime': 7733.5358, 'train_samples_per_second': 35.0, 'train_steps_per_second': 2.187, 'train_loss': 0.6901461484056348, 'epoch': 3.0}                                                                                                                                                                        
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16917/16917 [2:08:53<00:00,  2.19it/s]

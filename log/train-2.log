(.venv) sj683@en-cs-trummer-gpu01:~/replicate$ /home/sj683/replicate/.venv/bin/python /home/sj683/replicate/train.py
train - Dropping missing values: 90233 >> 90224
dev - Dropping missing values: 12792 >> 12792
test - Dropping missing values: 12779 >> 12779
Some weights of the model checkpoint at bert-base-multilingual-cased were not used when initializing BertForSequenceClassification: ['cls.seq_relationship.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.bias']
- This IS expected if you are initializing BertForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-multilingual-cased and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
cuda:0
/home/sj683/replicate/.venv/lib/python3.8/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
  0%|                                                                                                                                                                                                                                                                                        | 0/16917 [00:00<?, ?it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6899, 'learning_rate': 1.4775413711583924e-05, 'epoch': 0.09}                                                                                                                                                                                                                                               
  3%|███████▉                                                                                                                                                                                                                                                                    | 500/16917 [03:36<1:58:11,  2.31it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6865, 'learning_rate': 2.9550827423167847e-05, 'epoch': 0.18}                                                                                                                                                                                                                                               
  6%|███████████████▊                                                                                                                                                                                                                                                           | 1000/16917 [07:14<1:54:34,  2.32it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6761, 'learning_rate': 4.432624113475177e-05, 'epoch': 0.27}                                                                                                                                                                                                                                                
  9%|███████████████████████▋                                                                                                                                                                                                                                                   | 1500/16917 [10:53<1:51:33,  2.30it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6911, 'learning_rate': 4.898850574712644e-05, 'epoch': 0.35}                                                                                                                                                                                                                                                
 12%|███████████████████████████████▌                                                                                                                                                                                                                                           | 2000/16917 [14:31<1:47:14,  2.32it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6926, 'learning_rate': 4.7346469622331695e-05, 'epoch': 0.44}                                                                                                                                                                                                                                               
 15%|███████████████████████████████████████▍                                                                                                                                                                                                                                   | 2500/16917 [18:09<1:44:03,  2.31it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.692, 'learning_rate': 4.570443349753695e-05, 'epoch': 0.53}                                                                                                                                                                                                                                                 
 18%|███████████████████████████████████████████████▎                                                                                                                                                                                                                           | 3000/16917 [21:48<1:39:58,  2.32it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6915, 'learning_rate': 4.40623973727422e-05, 'epoch': 0.62}                                                                                                                                                                                                                                                 
 21%|███████████████████████████████████████████████████████▏                                                                                                                                                                                                                   | 3500/16917 [25:26<1:36:31,  2.32it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6921, 'learning_rate': 4.242036124794745e-05, 'epoch': 0.71}                                                                                                                                                                                                                                                
 24%|███████████████████████████████████████████████████████████████▏                                                                                                                                                                                                           | 4000/16917 [29:04<1:32:53,  2.32it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6896, 'learning_rate': 4.077832512315271e-05, 'epoch': 0.8}                                                                                                                                                                                                                                                 
 27%|███████████████████████████████████████████████████████████████████████                                                                                                                                                                                                    | 4500/16917 [32:42<1:29:30,  2.31it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6922, 'learning_rate': 3.9136288998357966e-05, 'epoch': 0.89}                                                                                                                                                                                                                                               
 30%|██████████████████████████████████████████████████████████████████████████████▉                                                                                                                                                                                            | 5000/16917 [36:21<1:25:47,  2.31it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'loss': 0.6907, 'learning_rate': 3.749425287356322e-05, 'epoch': 0.98}                                                                                                                                                                                                                                                
 33%|██████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                                                                                    | 5500/16917 [39:59<1:22:00,  2.32it/s]/home/sj683/replicate/.venv/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
{'eval_loss': 0.694210410118103, 'eval_accuracy': 0.5064102564102564, 'eval_runtime': 130.6419, 'eval_samples_per_second': 97.916, 'eval_steps_per_second': 6.124, 'epoch': 1.0}